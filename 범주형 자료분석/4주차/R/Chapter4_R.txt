>#------------------------------------ ----------------------------------#
>#                               Crab data                                        #
>#------------------------------------ ----------------------------------#
> crabs <- read.table("D:/course/SKKU/Category-Data-Analysis/Undergraduate/2021/SAS_R_code/R/crabs.dat",header=T)
> crabs
    color spine width satellites weight
1       3     3  28.3          8   3050
2       4     3  22.5          0   1550
3       2     1  26.0          9   2300
4       4     3  24.8          0   2100
5       4     3  26.0          4   2600
.
.
.

> attach(crabs)
The following objects are masked _by_ .GlobalEnv:

    color, weight

The following objects are masked from crabs (pos = 3):

    color, satellites, spine, weight, width

> y <- ifelse(satellites>0,1,0) # y=a binary indicator of satellites
> weight <- crabs$weight/1000   # weight in kilograms rather than grams
> color <- crabs$color-1              # now color takes values 1,2,3,4
> color.f1 <- factor(color)
> color.f <- relevel(color.f1,ref=4)
> spine.f <- factor(spine)
> dark <- as.numeric(color<4) # drakness
> 
> # normal model with identity link
> fit0 <- glm(y~weight, family=gaussian(link=identity))  
> summary(fit0)

Call:
glm(formula = y ~ weight, family = gaussian(link = identity))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8878  -0.4683   0.1606   0.3704   0.6689  

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.14487    0.14715  -0.984    0.326    
weight       0.32270    0.05876   5.492 1.42e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.1977574)

    Null deviance: 39.780  on 172  degrees of freedom
Residual deviance: 33.817  on 171  degrees of freedom
AIC: 214.56

Number of Fisher Scoring iterations: 2

> 
> # logistic regression with weight
> fit1 <- glm(y~weight, family=binomial(link=logit))
> summary(fit1)

Call:
glm(formula = y ~ weight, family = binomial(link = logit))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1108  -1.0749   0.5426   0.9122   1.6285  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -3.6947     0.8802  -4.198 2.70e-05 ***
weight        1.8151     0.3767   4.819 1.45e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 195.74  on 171  degrees of freedom
AIC: 199.74

Number of Fisher Scoring iterations: 4

> anova(fit1)
Analysis of Deviance Table

Model: binomial, link: logit

Response: y

Terms added sequentially (first to last)


       Df Deviance Resid. Df Resid. Dev
NULL                     172     225.76
weight  1   30.021       171     195.74
> 
> # logistic regression without covariate
> fit2 <- glm(y~1, family=binomial(link=logit))
> summary(fit2)

Call:
glm(formula = y ~ 1, family = binomial(link = logit))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.4326  -1.4326   0.9421   0.9421   0.9421  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   0.5824     0.1585   3.673 0.000239 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 225.76  on 172  degrees of freedom
AIC: 227.76

Number of Fisher Scoring iterations: 4

> anova(fit2)
Analysis of Deviance Table

Model: binomial, link: logit

Response: y

Terms added sequentially (first to last)


     Df Deviance Resid. Df Resid. Dev
NULL                   172     225.76
> 
> # logistic regression with weight and factor(color)
> fit3 <- glm(y~weight+color.f, family=binomial(link=logit))
> summary(fit3)

Call:
glm(formula = y ~ weight + color.f, family = binomial(link = logit))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1908  -1.0144   0.5101   0.8683   2.0751  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -4.5266     1.0038  -4.510 6.50e-06 ***
weight        1.6928     0.3888   4.354 1.34e-05 ***
color.f1      1.2694     0.8488   1.495  0.13479    
color.f2      1.4143     0.5449   2.595  0.00945 ** 
color.f3      1.0833     0.5884   1.841  0.06561 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 188.54  on 168  degrees of freedom
AIC: 198.54

Number of Fisher Scoring iterations: 4

> anova(fit3)
Analysis of Deviance Table

Model: binomial, link: logit

Response: y

Terms added sequentially (first to last)

        Df Deviance Resid. Df Resid. Dev
NULL                      172     225.76
weight   1  30.0214       171     195.74
color.f  3   7.1949       168     188.54
> 
> # logistic regression with weight and numeric(color)
> fit4 <- glm(y~weight+color, family=binomial(link=logit))
> summary(fit4)

Call:
glm(formula = y ~ weight + color, family = binomial(link = logit))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1596  -0.9998   0.5237   0.8825   1.9109  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -2.0316     1.1161  -1.820   0.0687 .  
weight        1.6531     0.3825   4.322 1.55e-05 ***
color        -0.5142     0.2234  -2.302   0.0213 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 190.27  on 170  degrees of freedom
AIC: 196.27

Number of Fisher Scoring iterations: 4

> anova(fit4)
Analysis of Deviance Table

Model: binomial, link: logit

Response: y

Terms added sequentially (first to last)


       Df Deviance Resid. Df Resid. Dev
NULL                     172     225.76
weight  1  30.0214       171     195.74
color   1   5.4684       170     190.27
> 
> # logistic regression with weight and dark
> fit5 <- glm(y~weight+dark, family=binomial(link=logit))
> summary(fit5)

Call:
glm(formula = y ~ weight + dark, family = binomial(link = logit))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1555  -1.0233   0.5132   0.8484   2.0873  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -4.6088     0.9922  -4.645 3.40e-06 ***
weight        1.7292     0.3825   4.520 6.18e-06 ***
dark          1.2954     0.5222   2.481   0.0131 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 189.17  on 170  degrees of freedom
AIC: 195.17

Number of Fisher Scoring iterations: 4

> anova(fit5)
Analysis of Deviance Table

Model: binomial, link: logit

Response: y

Terms added sequentially (first to last)

       Df Deviance Resid. Df Resid. Dev
NULL                     172     225.76
weight  1  30.0214       171     195.74
dark    1   6.5657       170     189.17
> 
> # Probit Model
> fit6 <- glm(y~weight,family=binomial(link=probit))
> summary(fit6)

Call:
glm(formula = y ~ weight, family = binomial(link = probit))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1436  -1.0774   0.5336   0.9196   1.6216  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -2.2383     0.5116  -4.375 1.22e-05 ***
weight        1.0990     0.2151   5.108 3.25e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 195.46  on 171  degrees of freedom
AIC: 199.46

Number of Fisher Scoring iterations: 4

> anova(fit6)
Analysis of Deviance Table

Model: binomial, link: probit

Response: y

Terms added sequentially (first to last)


       Df Deviance Resid. Df Resid. Dev
NULL                     172     225.76
weight  1   30.296       171     195.46
> 
> # LRT for models 1 & 2
> anova(fit2,fit1)
Analysis of Deviance Table

Model 1: y ~ 1
Model 2: y ~ weight
  Resid. Df Resid. Dev Df Deviance
1       172     225.76            
2       171     195.74  1   30.021
> 
> # LRT for models 1 & 3
> anova(fit1,fit3)
Analysis of Deviance Table

Model 1: y ~ weight
Model 2: y ~ weight + color.f
  Resid. Df Resid. Dev Df Deviance
1       171     195.74            
2       168     188.54  3   7.1949
> 
> # LRT for models 3 & 5
> anova(fit5,fit3)
Analysis of Deviance Table

Model 1: y ~ weight + dark
Model 2: y ~ weight + color.f
  Resid. Df Resid. Dev Df Deviance
1       170     189.17            
2       168     188.54  2  0.62923
> 
> 
> 
> #-----------------------------------------------------------------------#
> #                               death data                                       #
> #------------------------------------ ----------------------------------#
> 
> v <- c('b','b','w','w')
> d <- c('b','w','b','w')
> v.f1 <- factor(v)
> v.f <- relevel(v.f1,ref="w")
> d.f1 <- factor(d)
> d.f <- relevel(d.f1,ref="w")
> 
> p <- c(4,0,11,53)
> total <- c(143,16,48,467)
> death <- data.frame(v.f,d.f,p,total)
> 
> fit.death1 <- glm(p/total ~ d.f+v.f, family=binomial(link=logit), weight=total, data=death)
> summary(fit.death1)

Call:
glm(formula = p/total ~ d.f + v.f, family = binomial(link = logit), 
    data = death, weights = total)

Deviance Residuals: 
       1         2         3         4  
 0.09379  -0.60535  -0.06232   0.02660  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -2.0595     0.1458 -14.121  < 2e-16 ***
d.fb          0.8678     0.3671   2.364   0.0181 *  
v.fb         -2.4044     0.6006  -4.003 6.25e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 22.26591  on 3  degrees of freedom
Residual deviance:  0.37984  on 1  degrees of freedom
AIC: 19.3

Number of Fisher Scoring iterations: 4

> confint(fit.death1) #  likelihood ratio 95% confidence interval
Waiting for profiling to be done...
                 2.5 %    97.5 %
(Intercept) -2.3564626 -1.783591
d.fb         0.1140439  1.563332
v.fb        -3.7176025 -1.306854
> 
> fit.death2 <- glm(p/total ~ v.f, family=binomial(link=logit), weight=total, data=death)
> summary(fit.death2)

Call:
glm(formula = p/total ~ v.f, family = binomial(link = logit), 
    data = death, weights = total)

Deviance Residuals: 
      1        2        3        4  
 0.2112  -0.9030   2.0056  -0.7154  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -1.9526     0.1336 -14.618  < 2e-16 ***
v.fb         -1.7045     0.5237  -3.255  0.00114 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 22.266  on 3  degrees of freedom
Residual deviance:  5.394  on 2  degrees of freedom
AIC: 22.314

Number of Fisher Scoring iterations: 4

> confint(fit.death2) #  likelihood ratio 95% confidence interval
Waiting for profiling to be done...
                2.5 %     97.5 %
(Intercept) -2.223437 -1.6989436
v.fb        -2.907395 -0.7995714
> anova(fit.death2, fit.death1)
Analysis of Deviance Table

Model 1: p/total ~ v.f
Model 2: p/total ~ d.f + v.f
  Resid. Df Resid. Dev Df Deviance
1         2     5.3940            
2         1     0.3798  1   5.0142
> 
> 
> #-----------------------------------------------------------------------#
> #                      Probit model for  Bettle data                        #
> #------------------------------------ ----------------------------------#
> logdose <- c(1.691, 1.724, 1.755, 1.784, 1.811, 1.837, 1.861, 1.884)
> number <- c(59,60,62,56,63,59,62,60)
> died <- c(6,13,18,28,52,53,61,60)
> lived <- number-died
> beetle <- data.frame(logdose,number,died,lived)
> 
> fit.logit <- glm(died/number ~ logdose, family=binomial(link=logit),weight=number, data=beetle)
> summary(fit.logit)

Call:
glm(formula = died/number ~ logdose, family = binomial(link = logit), 
    data = beetle, weights = number)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5878  -0.4085   0.8442   1.2455   1.5860  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -60.740      5.182  -11.72   <2e-16 ***
logdose       34.286      2.913   11.77   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 284.202  on 7  degrees of freedom
Residual deviance:  11.116  on 6  degrees of freedom
AIC: 41.314

Number of Fisher Scoring iterations: 4

> confint(fit.logit)
Waiting for profiling to be done...
                2.5 %    97.5 %
(Intercept) -71.46808 -51.09973
logdose      28.86777  40.31875
> 
> fit.probit <- glm(died/number ~ logdose, family=binomial(link=probit),weight=number, data=beetle)
> summary(fit.probit)

Call:
glm(formula = died/number ~ logdose, family = binomial(link = probit), 
    data = beetle, weights = number)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5627  -0.4848   0.7647   1.0530   1.3149  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -34.956      2.649  -13.20   <2e-16 ***
logdose       19.741      1.488   13.27   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 284.202  on 7  degrees of freedom
Residual deviance:   9.987  on 6  degrees of freedom
AIC: 40.185

Number of Fisher Scoring iterations: 4

> confint(fit.probit)
Waiting for profiling to be done...
                2.5 %    97.5 %
(Intercept) -40.31414 -29.94712
logdose      16.92587  22.75551
> 
> fit.cloglog <- glm(died/number ~ logdose, family=binomial(link=cloglog),weight=number, data=beetle)
> summary(fit.cloglog)

Call:
glm(formula = died/number ~ logdose, family = binomial(link = cloglog), 
    data = beetle, weights = number)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.80002  -0.56588   0.01475   0.38096   1.31591  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -39.522      3.236  -12.21   <2e-16 ***
logdose       22.015      1.797   12.25   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 284.2024  on 7  degrees of freedom
Residual deviance:   3.5143  on 6  degrees of freedom
AIC: 33.712

Number of Fisher Scoring iterations: 4

> confint(fit.cloglog)
Waiting for profiling to be done...
                2.5 %    97.5 %
(Intercept) -46.13984 -33.49923
logdose      18.66945  25.68877
> 
> fit.loglog <- glm(lived/number ~ logdose, family=binomial(link=cloglog),weight=number, data=beetle)
> summary(fit.loglog)

Call:
glm(formula = lived/number ~ logdose, family = binomial(link = cloglog), 
    data = beetle, weights = number)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4425  -2.0554  -0.7002   0.4494   2.5362  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)   37.661      2.949   12.77   <2e-16 ***
logdose      -21.583      1.680  -12.85   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 284.202  on 7  degrees of freedom
Residual deviance:  27.573  on 6  degrees of freedom
AIC: 57.771

Number of Fisher Scoring iterations: 6

> confint(fit.loglog)
Waiting for profiling to be done...
                2.5 %    97.5 %
(Intercept)  32.35746  43.26168
logdose     -24.78665 -18.55895

