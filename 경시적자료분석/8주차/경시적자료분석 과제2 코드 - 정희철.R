# 3 - a part 1
beta_0 = rep(10,250)
beta_1 = rep(1,250)

set.seed(1)
b_0i = rnorm(250, mean = 0, sd = 1)
e_ij = rnorm(250, mean = 0, sd = 1)

obs_per_sub = c(1:10)
t_ij = rep(obs_per_sub, 25)

Y_ij = beta_0 + beta_1*t_ij + b_0i + e_ij
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
num3a_part1 = data.frame(Y = Y_ij, time = t_ij, subs = subject)

library(gridExtra)
library(lattice)
xyplot(Y ~ t_ij, data = num3a_part1, 
       type="l", group=subs,
       xlab="t_i",
       col.line="gray20",
       ylab="Y_i")

# 3 - a part 2
beta_0 = rep(10,250)
beta_1 = rep(1,250)

set.seed(1)
b_0i = rnorm(250, mean = 0, sd = 2)
e_ij = rnorm(250, mean = 0, sd = 1)

obs_per_sub = c(1:10)
t_ij = rep(obs_per_sub, 25)

Y_ij = beta_0 + beta_1*t_ij + b_0i + e_ij
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
num3a_part2 = data.frame(Y = Y_ij, time = t_ij, subs = subject)

library(gridExtra)
library(lattice)
xyplot(Y ~ t_ij, data = num3a_part2, 
       type="l", group=subs,
       xlab="t_i",
       col.line="blue",
       ylab="Y_i")

# 3 - a part 3
beta_0 = rep(10,250)
beta_1 = rep(1,250)

set.seed(1)
b_0i = rnorm(250, mean = 0, sd = 5)
e_ij = rnorm(250, mean = 0, sd = 1)

obs_per_sub = c(1:10)
t_ij = rep(obs_per_sub, 25)

Y_ij = beta_0 + beta_1*t_ij + b_0i + e_ij
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
num3a_part3 = data.frame(Y = Y_ij, time = t_ij, subs = subject)

library(gridExtra)
library(lattice)
xyplot(Y ~ t_ij, data = num3a_part3, 
       type="l", group=subs,
       xlab="t_i",
       col.line="red",
       ylab="Y_i")

# 3 - b part 1
b_0i = rnorm(250, mean = 0, sd = (2)^(1/2))
b_1i = rnorm(250, mean = 0, sd = (2)^(1/2))
e_ij = rnorm(250, mean = 0, sd = 1)

Y_ij = beta_0 + beta_1*t_ij + b_0i + b_1i*t_ij + e_ij
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
num3b_part1 = data.frame(Y = Y_ij, time = t_ij, subs = subject)

library(gridExtra)
library(lattice)
xyplot(Y ~ t_ij, data = num3b_part1, 
       type="l", group=subs,
       xlab="t_i",
       col.line="gray20",
       ylab="Y_i")

# 3 - b part 2
library(MASS)
library(tidyverse)
b_vcm = rbind(c((2)^(1/2), -(0.2)^(1/2)), c(-(0.2)^(1/2), (2)^(1/2)))
mu = c(0,0)
b = as.data.frame(mvrnorm(n=250, mu=mu, Sigma=b_vcm))
b_0i = b$V1
b_1i = b$V2
e_ij = rnorm(250, mean = 0, sd = 1)

Y_ij = beta_0 + beta_1*t_ij + b_0i + b_1i*t_ij + e_ij
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
num3b_part2 = data.frame(Y = Y_ij, time = t_ij, subs = subject)

library(gridExtra)
library(lattice)
xyplot(Y ~ t_ij, data = num3b_part2, 
       type="l", group=subs,
       xlab="t_i",
       col.line="blue",
       ylab="Y_i")

# 3 - b part 3
b_0i = rnorm(250, mean = 0, sd = (0.5)^(1/2))
b_1i = rnorm(250, mean = 0, sd = (0.4)^(1/2))
e_ij = rnorm(250, mean = 0, sd = 1)

Y_ij = beta_0 + beta_1*t_ij + b_0i + b_1i*t_ij + e_ij
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
num3b_part3 = data.frame(Y = Y_ij, time = t_ij, subs = subject)

library(gridExtra)
library(lattice)
xyplot(Y ~ t_ij, data = num3b_part3, 
       type="l", group=subs,
       xlab="t_i",
       col.line="red",
       ylab="Y_i")

# 3 - c part 1
beta_0 = rep(10,10)
beta_1 = rep(1,10)
t_ij = c(1:10)

wt_vcm = rbind(c(4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17), 4*(0.7)^(18), 4*(0.7)^(19), 4*(0.7)^(20), 4*(0.7)^(21), 4*(0.7)^(22), 4*(0.7)^(23), 4*(0.7)^(24)),
               c(4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17), 4*(0.7)^(18), 4*(0.7)^(19), 4*(0.7)^(20), 4*(0.7)^(21), 4*(0.7)^(22), 4*(0.7)^(23)),
               c(4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17), 4*(0.7)^(18), 4*(0.7)^(19), 4*(0.7)^(20), 4*(0.7)^(21), 4*(0.7)^(22)),
               c(4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17), 4*(0.7)^(18), 4*(0.7)^(19), 4*(0.7)^(20), 4*(0.7)^(21)),
               c(4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17), 4*(0.7)^(18), 4*(0.7)^(19), 4*(0.7)^(20)),
               c(4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17), 4*(0.7)^(18), 4*(0.7)^(19)),
               c(4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17), 4*(0.7)^(18)),
               c(4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16), 4*(0.7)^(17)),
               c(4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15), 4*(0.7)^(16)),
               c(4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14), 4*(0.7)^(15)),
               c(4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13), 4*(0.7)^(14)),
               c(4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12), 4*(0.7)^(13)),
               c(4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11), 4*(0.7)^(12)),
               c(4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10), 4*(0.7)^(11)),
               c(4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9), 4*(0.7)^(10)),
               c(4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8), 4*(0.7)^(9)),
               c(4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7), 4*(0.7)^(8)),
               c(4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6), 4*(0.7)^(7)),
               c(4*(0.7)^(18), 4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5), 4*(0.7)^(6)),
               c(4*(0.7)^(19), 4*(0.7)^(18), 4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4), 4*(0.7)^(5)),
               c(4*(0.7)^(20), 4*(0.7)^(19), 4*(0.7)^(18), 4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3), 4*(0.7)^(4)),
               c(4*(0.7)^(21), 4*(0.7)^(20), 4*(0.7)^(19), 4*(0.7)^(18), 4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2), 4*(0.7)^(3)),
               c(4*(0.7)^(22), 4*(0.7)^(21), 4*(0.7)^(20), 4*(0.7)^(19), 4*(0.7)^(18), 4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1), 4*(0.7)^(2)),
               c(4*(0.7)^(23), 4*(0.7)^(22), 4*(0.7)^(21), 4*(0.7)^(20), 4*(0.7)^(19), 4*(0.7)^(18), 4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4, 4*(0.7)^(1)),
               c(4*(0.7)^(24), 4*(0.7)^(23), 4*(0.7)^(22), 4*(0.7)^(21), 4*(0.7)^(20), 4*(0.7)^(19), 4*(0.7)^(18), 4*(0.7)^(17), 4*(0.7)^(16), 4*(0.7)^(15), 4*(0.7)^(14), 4*(0.7)^(13), 4*(0.7)^(12), 4*(0.7)^(11), 4*(0.7)^(10), 4*(0.7)^(9), 4*(0.7)^(8), 4*(0.7)^(7), 4*(0.7)^(6), 4*(0.7)^(5), 4*(0.7)^(4), 4*(0.7)^(3), 4*(0.7)^(2), 4*(0.7)^(1), 4))

wt_vcm = (wt_vcm)^(1/2)
mu = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
wt = as.data.frame(mvrnorm(n=10, mu=mu, Sigma=wt_vcm))
wt_1 = wt$V1
wt_2 = wt$V2
wt_3 = wt$V3
wt_4 = wt$V4
wt_5 = wt$V5
wt_6 = wt$V6
wt_7 = wt$V7
wt_8 = wt$V8
wt_9 = wt$V9
wt_10 = wt$V10
wt_11 = wt$V11
wt_12 = wt$V12
wt_13 = wt$V13
wt_14 = wt$V14
wt_15 = wt$V15
wt_16 = wt$V16
wt_17 = wt$V17
wt_18 = wt$V18
wt_19 = wt$V19
wt_20 = wt$V20
wt_21 = wt$V21
wt_22 = wt$V22
wt_23 = wt$V23
wt_24 = wt$V24
wt_25 = wt$V25

e_ij = rnorm(250, mean = 0, sd = 1)

Y_1 = beta_0 + beta_1*t_ij + wt_1 + e_ij[1:10]
Y_2 = beta_0 + beta_1*t_ij + wt_2 + e_ij[11:20]
Y_3 = beta_0 + beta_1*t_ij + wt_3 + e_ij[21:30]
Y_4 = beta_0 + beta_1*t_ij + wt_4 + e_ij[31:40]
Y_5 = beta_0 + beta_1*t_ij + wt_5 + e_ij[41:50]
Y_6 = beta_0 + beta_1*t_ij + wt_6 + e_ij[51:60]
Y_7 = beta_0 + beta_1*t_ij + wt_7 + e_ij[61:70]
Y_8 = beta_0 + beta_1*t_ij + wt_8 + e_ij[71:80]
Y_9 = beta_0 + beta_1*t_ij + wt_9 + e_ij[81:90]
Y_10 = beta_0 + beta_1*t_ij + wt_10 + e_ij[91:100]
Y_11 = beta_0 + beta_1*t_ij + wt_11 + e_ij[101:110]
Y_12 = beta_0 + beta_1*t_ij + wt_12 + e_ij[111:120]
Y_13 = beta_0 + beta_1*t_ij + wt_13 + e_ij[121:130]
Y_14 = beta_0 + beta_1*t_ij + wt_14 + e_ij[131:140]
Y_15 = beta_0 + beta_1*t_ij + wt_15 + e_ij[141:150]
Y_16 = beta_0 + beta_1*t_ij + wt_16 + e_ij[151:160]
Y_17 = beta_0 + beta_1*t_ij + wt_17 + e_ij[161:170]
Y_18 = beta_0 + beta_1*t_ij + wt_18 + e_ij[171:180]
Y_19 = beta_0 + beta_1*t_ij + wt_19 + e_ij[181:190]
Y_20 = beta_0 + beta_1*t_ij + wt_20 + e_ij[191:200]
Y_21 = beta_0 + beta_1*t_ij + wt_21 + e_ij[201:210]
Y_22 = beta_0 + beta_1*t_ij + wt_22 + e_ij[211:220]
Y_23 = beta_0 + beta_1*t_ij + wt_23 + e_ij[221:230]
Y_24 = beta_0 + beta_1*t_ij + wt_24 + e_ij[231:240]
Y_25 = beta_0 + beta_1*t_ij + wt_25 + e_ij[241:250]

Y = c(Y_1, Y_2, Y_3, Y_4, Y_5, Y_6, Y_7, Y_8, Y_9, Y_10, Y_11, Y_12, Y_13, Y_14, Y_15, Y_16, Y_17, Y_18, Y_19, Y_20, Y_21, Y_22, Y_23, Y_24, Y_25)
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
obs_per_sub = c(1:10)
t_ij = rep(obs_per_sub, 25)
num3c_part1 = data.frame(Y = Y, time = t_ij, subs = subject)

xyplot(Y ~ time, data = num3c_part1, 
       type="l", group=subs,
       xlab="t_i",
       col.line="gray20",
       ylab="Y_i")
# 3 - c part 2
beta_0 = rep(10,10)
beta_1 = rep(1,10)
t_ij = c(1:10)

wt_vcm = rbind(c(4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17), 4*(0.9)^(18), 4*(0.9)^(19), 4*(0.9)^(20), 4*(0.9)^(21), 4*(0.9)^(22), 4*(0.9)^(23), 4*(0.9)^(24)),
               c(4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17), 4*(0.9)^(18), 4*(0.9)^(19), 4*(0.9)^(20), 4*(0.9)^(21), 4*(0.9)^(22), 4*(0.9)^(23)),
               c(4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17), 4*(0.9)^(18), 4*(0.9)^(19), 4*(0.9)^(20), 4*(0.9)^(21), 4*(0.9)^(22)),
               c(4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17), 4*(0.9)^(18), 4*(0.9)^(19), 4*(0.9)^(20), 4*(0.9)^(21)),
               c(4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17), 4*(0.9)^(18), 4*(0.9)^(19), 4*(0.9)^(20)),
               c(4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17), 4*(0.9)^(18), 4*(0.9)^(19)),
               c(4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17), 4*(0.9)^(18)),
               c(4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16), 4*(0.9)^(17)),
               c(4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15), 4*(0.9)^(16)),
               c(4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14), 4*(0.9)^(15)),
               c(4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13), 4*(0.9)^(14)),
               c(4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12), 4*(0.9)^(13)),
               c(4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11), 4*(0.9)^(12)),
               c(4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10), 4*(0.9)^(11)),
               c(4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9), 4*(0.9)^(10)),
               c(4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8), 4*(0.9)^(9)),
               c(4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7), 4*(0.9)^(8)),
               c(4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6), 4*(0.9)^(7)),
               c(4*(0.9)^(18), 4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5), 4*(0.9)^(6)),
               c(4*(0.9)^(19), 4*(0.9)^(18), 4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4), 4*(0.9)^(5)),
               c(4*(0.9)^(20), 4*(0.9)^(19), 4*(0.9)^(18), 4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3), 4*(0.9)^(4)),
               c(4*(0.9)^(21), 4*(0.9)^(20), 4*(0.9)^(19), 4*(0.9)^(18), 4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2), 4*(0.9)^(3)),
               c(4*(0.9)^(22), 4*(0.9)^(21), 4*(0.9)^(20), 4*(0.9)^(19), 4*(0.9)^(18), 4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1), 4*(0.9)^(2)),
               c(4*(0.9)^(23), 4*(0.9)^(22), 4*(0.9)^(21), 4*(0.9)^(20), 4*(0.9)^(19), 4*(0.9)^(18), 4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4, 4*(0.9)^(1)),
               c(4*(0.9)^(24), 4*(0.9)^(23), 4*(0.9)^(22), 4*(0.9)^(21), 4*(0.9)^(20), 4*(0.9)^(19), 4*(0.9)^(18), 4*(0.9)^(17), 4*(0.9)^(16), 4*(0.9)^(15), 4*(0.9)^(14), 4*(0.9)^(13), 4*(0.9)^(12), 4*(0.9)^(11), 4*(0.9)^(10), 4*(0.9)^(9), 4*(0.9)^(8), 4*(0.9)^(7), 4*(0.9)^(6), 4*(0.9)^(5), 4*(0.9)^(4), 4*(0.9)^(3), 4*(0.9)^(2), 4*(0.9)^(1), 4))

wt_vcm = (wt_vcm)^(1/2)
mu = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
wt = as.data.frame(mvrnorm(n=10, mu=mu, Sigma=wt_vcm))
wt_1 = wt$V1
wt_2 = wt$V2
wt_3 = wt$V3
wt_4 = wt$V4
wt_5 = wt$V5
wt_6 = wt$V6
wt_7 = wt$V7
wt_8 = wt$V8
wt_9 = wt$V9
wt_10 = wt$V10
wt_11 = wt$V11
wt_12 = wt$V12
wt_13 = wt$V13
wt_14 = wt$V14
wt_15 = wt$V15
wt_16 = wt$V16
wt_17 = wt$V17
wt_18 = wt$V18
wt_19 = wt$V19
wt_20 = wt$V20
wt_21 = wt$V21
wt_22 = wt$V22
wt_23 = wt$V23
wt_24 = wt$V24
wt_25 = wt$V25

e_ij = rnorm(250, mean = 0, sd = 1)

Y_1 = beta_0 + beta_1*t_ij + wt_1 + e_ij[1:10]
Y_2 = beta_0 + beta_1*t_ij + wt_2 + e_ij[11:20]
Y_3 = beta_0 + beta_1*t_ij + wt_3 + e_ij[21:30]
Y_4 = beta_0 + beta_1*t_ij + wt_4 + e_ij[31:40]
Y_5 = beta_0 + beta_1*t_ij + wt_5 + e_ij[41:50]
Y_6 = beta_0 + beta_1*t_ij + wt_6 + e_ij[51:60]
Y_7 = beta_0 + beta_1*t_ij + wt_7 + e_ij[61:70]
Y_8 = beta_0 + beta_1*t_ij + wt_8 + e_ij[71:80]
Y_9 = beta_0 + beta_1*t_ij + wt_9 + e_ij[81:90]
Y_10 = beta_0 + beta_1*t_ij + wt_10 + e_ij[91:100]
Y_11 = beta_0 + beta_1*t_ij + wt_11 + e_ij[101:110]
Y_12 = beta_0 + beta_1*t_ij + wt_12 + e_ij[111:120]
Y_13 = beta_0 + beta_1*t_ij + wt_13 + e_ij[121:130]
Y_14 = beta_0 + beta_1*t_ij + wt_14 + e_ij[131:140]
Y_15 = beta_0 + beta_1*t_ij + wt_15 + e_ij[141:150]
Y_16 = beta_0 + beta_1*t_ij + wt_16 + e_ij[151:160]
Y_17 = beta_0 + beta_1*t_ij + wt_17 + e_ij[161:170]
Y_18 = beta_0 + beta_1*t_ij + wt_18 + e_ij[171:180]
Y_19 = beta_0 + beta_1*t_ij + wt_19 + e_ij[181:190]
Y_20 = beta_0 + beta_1*t_ij + wt_20 + e_ij[191:200]
Y_21 = beta_0 + beta_1*t_ij + wt_21 + e_ij[201:210]
Y_22 = beta_0 + beta_1*t_ij + wt_22 + e_ij[211:220]
Y_23 = beta_0 + beta_1*t_ij + wt_23 + e_ij[221:230]
Y_24 = beta_0 + beta_1*t_ij + wt_24 + e_ij[231:240]
Y_25 = beta_0 + beta_1*t_ij + wt_25 + e_ij[241:250]

Y = c(Y_1, Y_2, Y_3, Y_4, Y_5, Y_6, Y_7, Y_8, Y_9, Y_10, Y_11, Y_12, Y_13, Y_14, Y_15, Y_16, Y_17, Y_18, Y_19, Y_20, Y_21, Y_22, Y_23, Y_24, Y_25)
subject = c(rep('1',10), rep('2',10), rep('3',10), rep('4',10), rep('5',10), 
            rep('6',10), rep('7',10), rep('8',10), rep('9',10), rep('10',10), 
            rep('11',10), rep('12',10), rep('13',10), rep('14',10),  rep('15',10), 
            rep('16',10), rep('17',10), rep('18',10), rep('19',10), rep('20',10), 
            rep('21',10), rep('22',10), rep('23',10), rep('24',10), rep('25',10))
obs_per_sub = c(1:10)
t_ij = rep(obs_per_sub, 25)
num3c_part2 = data.frame(Y = Y, time = t_ij, subs = subject)

xyplot(Y ~ time, data = num3c_part2, 
       type="l", group=subs,
       xlab="t_i",
       col.line="blue",
       ylab="Y_i")
# 3 - c part 3
beta_0 = rep(10,10)
beta_1 = rep(1,10)
t_ij = c(1:10)
e_ij = rnorm(250, mean = 0, sd = 2)
Y_1 = beta_0 + beta_1*t_ij + wt_1 + e_ij[1:10]
Y_2 = beta_0 + beta_1*t_ij + wt_2 + e_ij[11:20]
Y_3 = beta_0 + beta_1*t_ij + wt_3 + e_ij[21:30]
Y_4 = beta_0 + beta_1*t_ij + wt_4 + e_ij[31:40]
Y_5 = beta_0 + beta_1*t_ij + wt_5 + e_ij[41:50]
Y_6 = beta_0 + beta_1*t_ij + wt_6 + e_ij[51:60]
Y_7 = beta_0 + beta_1*t_ij + wt_7 + e_ij[61:70]
Y_8 = beta_0 + beta_1*t_ij + wt_8 + e_ij[71:80]
Y_9 = beta_0 + beta_1*t_ij + wt_9 + e_ij[81:90]
Y_10 = beta_0 + beta_1*t_ij + wt_10 + e_ij[91:100]
Y_11 = beta_0 + beta_1*t_ij + wt_11 + e_ij[101:110]
Y_12 = beta_0 + beta_1*t_ij + wt_12 + e_ij[111:120]
Y_13 = beta_0 + beta_1*t_ij + wt_13 + e_ij[121:130]
Y_14 = beta_0 + beta_1*t_ij + wt_14 + e_ij[131:140]
Y_15 = beta_0 + beta_1*t_ij + wt_15 + e_ij[141:150]
Y_16 = beta_0 + beta_1*t_ij + wt_16 + e_ij[151:160]
Y_17 = beta_0 + beta_1*t_ij + wt_17 + e_ij[161:170]
Y_18 = beta_0 + beta_1*t_ij + wt_18 + e_ij[171:180]
Y_19 = beta_0 + beta_1*t_ij + wt_19 + e_ij[181:190]
Y_20 = beta_0 + beta_1*t_ij + wt_20 + e_ij[191:200]
Y_21 = beta_0 + beta_1*t_ij + wt_21 + e_ij[201:210]
Y_22 = beta_0 + beta_1*t_ij + wt_22 + e_ij[211:220]
Y_23 = beta_0 + beta_1*t_ij + wt_23 + e_ij[221:230]
Y_24 = beta_0 + beta_1*t_ij + wt_24 + e_ij[231:240]
Y_25 = beta_0 + beta_1*t_ij + wt_25 + e_ij[241:250]
Y = c(Y_1, Y_2, Y_3, Y_4, Y_5, Y_6, Y_7, Y_8, Y_9, Y_10, Y_11, Y_12, Y_13, Y_14, Y_15, Y_16, Y_17, Y_18, Y_19, Y_20, Y_21, Y_22, Y_23, Y_24, Y_25)
obs_per_sub = c(1:10)
t_ij = rep(obs_per_sub, 25)
num3c_part3 = data.frame(Y = Y, time = t_ij, subs = subject)

xyplot(Y ~ time, data = num3c_part3, 
       type="l", group=subs,
       xlab="t_i",
       col.line="red",
       ylab="Y_i")



# 4

lead <- read.table('lead.dat')
lead
# V1 : Child ID
# V2 : Age Indicator - 0 if less than equal to 24 months, 1 if greater than 24 months
# V3 : Gender Indicator - 0 for female, 1 for male
# V4 : week - 0, 2, 4, 6, 8
# V5 : Blood Lead Level 
# V6 : Treatment Indicator - 0 for placebo, 1 for low does, 2 for higher dose

# 4 - a
# Spaghetti plot
lead_v6_1 = lead[lead$V6 == 1,]
lead_v6_2 = lead[lead$V6 == 2,]
lead_v6_3 = lead[lead$V6 == 3,]

library(gridExtra)
library(lattice)

spaghetti_1 = xyplot(V5 ~ V4, data = lead_v6_1, 
       type="l", group=V1,
       xlab="weeks of dosage (placebo)",
       col.line="gray20",
       ylab="Blood Lead Level")

spaghetti_2 = xyplot(V5 ~ V4, data = lead_v6_2, 
       type="l", group=V1,
       xlab="weeks of dosage (low dose)",
       col.line="gray20",
       ylab="Blood Lead Level")

spaghetti_3 = xyplot(V5 ~ V4, data = lead_v6_3, 
       type="l", group=V1,
       xlab="weeks of dosage (higher dose)",
       col.line="gray20",
       ylab="Blood Lead Level")
grid.arrange(spaghetti_1, spaghetti_2, spaghetti_3, ncol = 3)   
## Inferring ONLY from the different spaghetti plots for each treatment group, all three groups have a decreasing trend to some degree. 
### As for the placebo group, it is hard to say that there is a strong decreasing trend, but it is clear there is a cluster having a decreasing trend. 
### As for the group with low dosage, most of the children show a decreasing trend. 
### As for the group with higher dosage, apart from the few children showing a rather straight trend, the majority of children form a cluster of decreasing trend. 

# 4 - b

